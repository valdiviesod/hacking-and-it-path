(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{75:function(e,t,i){"use strict";i.r(t);var n=i(2),s=i.n(n);function r(e,t,i,n,s,r,o){try{var a=e[r](o),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(n,s)}var o,a,l={data:function(){return{np2Display:void 0,npFeed:[],npFeedWC:[],gazSiteDirectory:defaults.gaz_site_directory,country:defaults.COUNTRY,analyticsEndpoint:"https://ingest.grupoadslzone.es/",ttl:3e5}},methods:{isSessionStorageAlive:function(){if(null!==sessionStorage.getItem("np_feed_obj")&&null!==sessionStorage.getItem("np_feed_wc")){var e=JSON.parse(sessionStorage.getItem("np_feed_obj")),t=e.time+e.ttl;return(new Date).getTime()<t}return!1},getNp2Display:function(){this.isSessionStorageAlive()?(this.npFeed=JSON.parse(sessionStorage.getItem("np_feed_obj")).feed,this.npFeedWC=JSON.parse(sessionStorage.getItem("np_feed_wc")),this.getNextNp2display()):this.fetchFeed()},fetchFeed:(o=s.a.mark((function e(){var t=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://promotions.grupoadslzone.es/v1/featured/".concat(this.gazSiteDirectory),{signal:AbortSignal.timeout(1e3)}).then((function(e){return e.json()})).then((function(e){e.featured&&(t.npFeedWC=t.npFeed=e.featured,t.createSessionStorage(),t.getNextNp2display())})).catch((function(e){"AbortError"===e.name?console.log("%c NEWS PROMOTION fetch aborted after 1sec ","background: grey; color: white; border-radius:3px"):console.log(e)}));case 2:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(i,n){var s=o.apply(e,t);function a(e){r(s,i,n,a,l,"next",e)}function l(e){r(s,i,n,a,l,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)}),createSessionStorage:function(){var e={time:(new Date).getTime(),feed:this.npFeed,ttl:this.ttl};sessionStorage.setItem("np_feed_obj",JSON.stringify(e)),sessionStorage.setItem("np_feed_wc",JSON.stringify(this.npFeed))},canDisplayNp:function(e){return void 0!==e&&(!!this.isHomeOrPreview()||(!e.url.includes(this.$route.path)||(this.removeNpFromWorkingCopy(e),!1)))},getNextNp2display:function(){1===this.npFeedWC.length&&this.npFeedWC[0].url.includes(this.$route.path)&&(sessionStorage.setItem("np_feed_wc",JSON.stringify(this.npFeed)),this.npFeedWC=this.npFeed);for(var e=void 0;!this.canDisplayNp(e);)e=this.getRandomWeightedNp();this.removeNpFromWorkingCopy(e),this.np2Display=e},isHomeOrPreview:function(){return"/"===this.$route.path||this.pageObject.get().isHome()},getRandomWeightedNp:function(){if(1===this.npFeedWC.length)return this.npFeedWC[0];for(var e=0,t=0;t<this.npFeedWC.length;++t){e+=void 0!==this.npFeedWC[t].weight?this.npFeedWC[t].weight:0}var i=Math.random()*e;e=0;for(var n=0;n<this.npFeedWC.length-1;++n){if((e+=void 0!==this.npFeedWC[n].weight?this.npFeedWC[n].weight:0)>=i)return this.npFeedWC[n]}return this.npFeedWC[this.npFeedWC.length-1]},removeNpFromWorkingCopy:function(e){1===this.npFeedWC.length?sessionStorage.setItem("np_feed_wc",JSON.stringify(this.npFeed)):(this.npFeedWC=this.npFeedWC.filter((function(t){return t.url!==e.url})),sessionStorage.setItem("np_feed_wc",JSON.stringify(this.npFeedWC)))},registerClick:function(e){registerEventAnalytics("click",e)},registerImpression:function(e,t){registerImpressionAnalytics(e,t)}}},d=i(0),p={extends:Object(d.a)(l,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null).exports,data:function(){return{isCardVisible:!1,adBlock:null,isImageLoaded:!1,impressionSent:!1,fixedSitesEl:void 0}},mounted:function(){this.getNp2Display(),this.fixedSitesEl=document.querySelector(".fixed-sites")},methods:{handleScroll:function(){Math.round(window.scrollY)>350&&(this.isCardVisible=!0,this.fixedSitesEl.classList.add("np-visible"),window.removeEventListener("scroll",this.handleScroll,!1))},removeCard:function(){this.isCardVisible=!1,this.fixedSitesEl.classList.remove("np-visible");var e=this;setTimeout((function(){window.removeEventListener("scroll",this.handleScroll),e.np2Display=void 0}),400)}},watch:{isImageLoaded:function(e){if(e){window.addEventListener("scroll",this.handleScroll,!1)}},isCardVisible:function(e){!this.impressionSent&&e&&(this.registerImpression("box",this.np2Display.url),this.impressionSent=!0)}}},c=Object(d.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return void 0!==e.np2Display?i("div",{ref:"featuredNpCard",class:["np-card",{"np-card--visible":e.isCardVisible}]},[i("a",{staticClass:"np-card__close-btn",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.removeCard(t)}}},[i("i",{staticClass:"icon-close"})]),e._v(" "),i("div",{staticClass:"np-card__container"},[i("a",{attrs:{href:e.np2Display.url},on:{click:function(t){return e.registerClick(e.np2Display.url)}}},[i("img",{staticClass:"np-card__image",attrs:{src:e.np2Display.image+"?x=250",width:"250",height:"75"},on:{load:function(t){e.isImageLoaded=!0}}}),e._v(" "),i("div",{staticClass:"np-card__content"},[i("div",{staticClass:"np-card__label"},[e._v(e._s(e.np2Display.label))]),e._v(" "),i("div",{staticClass:"np-card__title"},[e._v(e._s(e.np2Display.title))])])]),e._v(" "),i("div",{staticClass:"np-card__logo-wrapper"},[i("img",{attrs:{src:"/app/themes/gaz-v1/dist/themes/gaz/images/gaz-logos/initials/"+e.np2Display.site+"_initial.png?x=45",width:"45",height:"20",alt:e.np2Display.site+" logo"}})])])]):e._e()}),[],!1,null,null,null);t.default=c.exports}}]);